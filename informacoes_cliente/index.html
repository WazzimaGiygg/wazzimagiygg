<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil do Cliente - WZZM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Container Principal */
        .app-container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            min-height: 80vh;
        }

        /* Header */
        .app-header {
            background: linear-gradient(135deg, #3f51b5 0%, #2196f3 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .app-logo {
            font-size: 2.5rem;
        }

        .app-title {
            font-size: 2rem;
            font-weight: 300;
        }

        .header-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* Bot√µes */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4caf50;
            color: white;
        }

        .btn-primary:hover {
            background: #388e3c;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #ff9800;
            color: white;
        }

        .btn-secondary:hover {
            background: #f57c00;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        /* Tela de Login */
        .login-screen {
            padding: 60px 40px;
            text-align: center;
        }

        .login-card {
            max-width: 500px;
            margin: 0 auto;
            padding: 40px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .login-title {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 20px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .login-btn {
            background: #4285f4;
            color: white;
            padding: 18px 30px;
            border-radius: 12px;
            border: none;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            background: #357ae8;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.3);
        }

        .google-icon {
            background: white;
            color: #4285f4;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.3rem;
        }

        /* Loading */
        .loading-container {
            text-align: center;
            padding: 60px 20px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3f51b5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Erros */
        .error-container {
            background: #ffebee;
            color: #c62828;
            padding: 30px;
            border-radius: 15px;
            margin: 30px;
            border-left: 5px solid #c62828;
        }

        .error-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        /* Dados do Cliente */
        .client-data {
            padding: 40px;
            display: none;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .data-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #3f51b5;
        }

        .data-card h3 {
            color: #3f51b5;
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .data-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .data-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-value {
            color: #333;
            font-size: 1.1rem;
            word-break: break-word;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .badge-admin {
            background: #4caf50;
            color: white;
        }

        .badge-user {
            background: #2196f3;
            color: white;
        }

        .badge-banned {
            background: #f44336;
            color: white;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .app-header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .data-grid {
                grid-template-columns: 1fr;
            }
            
            .client-data {
                padding: 20px;
            }
            
            .login-card {
                padding: 30px 20px;
            }
        }

        /* Debug */
        .debug-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .debug-btn {
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
            transition: all 0.3s ease;
        }

        .debug-btn:hover {
            transform: scale(1.1);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
        }
    </style>
</head>
<body>
    <!-- Bot√£o de Debug -->
    <div class="debug-panel">
        <button class="debug-btn" onclick="debugFirebase()">üêõ</button>
    </div>

    <!-- Container Principal -->
    <div class="app-container">
        <!-- Header (vis√≠vel ap√≥s login) -->
        <div class="app-header" id="appHeader" style="display: none;">
            <div class="header-left">
                <div class="app-logo">üë§</div>
                <h1 class="app-title">Perfil do Cliente</h1>
            </div>
            <div class="header-right">
                <span class="badge badge-user" id="userBadge">Usu√°rio</span>
                <button class="btn btn-danger" onclick="logout()">
                    <span>üö™</span> Sair
                </button>
            </div>
        </div>

        <!-- Tela de Login -->
        <div class="login-screen" id="loginScreen">
            <div class="login-card">
                <h1 class="login-title">Bem-vindo ao WZZM</h1>
                <p class="login-subtitle">
                    Fa√ßa login para acessar seu perfil de cliente.<br>
                    Se for sua primeira vez, criaremos um perfil automaticamente.
                </p>
                
                <button class="login-btn" onclick="loginWithGoogle()">
                    <span class="google-icon">G</span>
                    Entrar com Google
                </button>
                
                <div style="margin-top: 30px; padding: 20px; background: #f5f5f5; border-radius: 10px;">
                    <p style="color: #666; font-size: 0.9rem;">
                        <strong>üìã Informa√ß√µes:</strong><br>
                        ‚Ä¢ Seus dados s√£o protegidos por criptografia<br>
                        ‚Ä¢ Apenas voc√™ e administradores podem ver estas informa√ß√µes<br>
                        ‚Ä¢ Voc√™ pode editar seus dados a qualquer momento
                    </p>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div class="loading-container" id="loadingScreen" style="display: none;">
            <div class="spinner"></div>
            <h2>Carregando seus dados...</h2>
            <p>Por favor, aguarde enquanto buscamos suas informa√ß√µes.</p>
        </div>

        <!-- Erros -->
        <div class="error-container" id="errorScreen" style="display: none;">
            <div class="error-title">
                <span>‚ùå</span>
                <h3>Erro ao Carregar Dados</h3>
            </div>
            <p id="errorMessage">Mensagem de erro</p>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="location.reload()">
                    üîÑ Tentar Novamente
                </button>
                <button class="btn btn-secondary" onclick="debugFirebase()">
                    üêõ Debug
                </button>
            </div>
        </div>

        <!-- Dados do Cliente -->
        <div class="client-data" id="clientDataScreen">
            <div class="data-grid">
                <!-- Informa√ß√µes B√°sicas -->
                <div class="data-card">
                    <h3>üë§ Identifica√ß√£o</h3>
                    <div class="data-item">
                        <div class="data-label">UID</div>
                        <div class="data-value" id="uidField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Nome Completo</div>
                        <div class="data-value" id="nameField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">CPF</div>
                        <div class="data-value" id="cpfField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">RG</div>
                        <div class="data-value" id="rgField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Nome Social</div>
                        <div class="data-value" id="socialNameField"></div>
                    </div>
                </div>

                <!-- Dados Pessoais -->
                <div class="data-card">
                    <h3>üìÖ Dados Pessoais</h3>
                    <div class="data-item">
                        <div class="data-label">Data de Nascimento</div>
                        <div class="data-value" id="birthDateField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">G√™nero</div>
                        <div class="data-value" id="genderField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Data de Cadastro</div>
                        <div class="data-value" id="createdAtField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">√öltima Atualiza√ß√£o</div>
                        <div class="data-value" id="updatedAtField"></div>
                    </div>
                </div>

                <!-- Contato -->
                <div class="data-card">
                    <h3>üìû Contato</h3>
                    <div class="data-item">
                        <div class="data-label">Telefone(s)</div>
                        <div class="data-value" id="phoneField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">E-mail(s)</div>
                        <div class="data-value" id="emailField"></div>
                    </div>
                </div>

                <!-- Endere√ßo -->
                <div class="data-card">
                    <h3>üè† Endere√ßo</h3>
                    <div class="data-item">
                        <div class="data-label">Endere√ßo</div>
                        <div class="data-value" id="addressField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">CEP</div>
                        <div class="data-value" id="zipCodeField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Cidade/Estado</div>
                        <div class="data-value" id="cityStateField"></div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Pa√≠s</div>
                        <div class="data-value" id="countryField"></div>
                    </div>
                </div>
            </div>

            <!-- A√ß√µes -->
            <div style="display: flex; gap: 15px; margin-top: 40px;">
                <button class="btn btn-primary" onclick="editProfile()">
                    ‚úèÔ∏è Editar Perfil
                </button>
                <button class="btn btn-secondary" onclick="refreshData()">
                    üîÑ Atualizar
                </button>
                <button class="btn btn-secondary" onclick="window.print()">
                    üñ®Ô∏è Imprimir
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>

    <script>
        // ========== CONFIGURA√á√ÉO FIREBASE ==========
        const firebaseConfig = {
            apiKey: "AIzaSyB9GkSqTIZ0kbVsba_WOdQeVAETrF9qna0",
            authDomain: "wzzm-ce3fc.firebaseapp.com",
            projectId: "wzzm-ce3fc",
            storageBucket: "wzzm-ce3fc.appspot.com",
            messagingSenderId: "249427877153",
            appId: "1:249427877153:web:0e4297294794a5aadeb260",
            measurementId: "G-PLKNZNFCQ8"
        };

        // Inicializar
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
            console.log('‚úÖ Firebase inicializado');
        }
        
        const db = firebase.firestore();
        const auth = firebase.auth();
        const googleProvider = new firebase.auth.GoogleAuthProvider();

        // ========== ELEMENTOS ==========
        const loginScreen = document.getElementById('loginScreen');
        const appHeader = document.getElementById('appHeader');
        const loadingScreen = document.getElementById('loadingScreen');
        const errorScreen = document.getElementById('errorScreen');
        const clientDataScreen = document.getElementById('clientDataScreen');
        const errorMessage = document.getElementById('errorMessage');
        const userBadge = document.getElementById('userBadge');

        // ========== ESTADO ==========
        let currentUserId = null;
        let isAdminUser = false;

        // ========== FUN√á√ïES DE LOGIN ==========
        async function loginWithGoogle() {
            try {
                console.log('üîê Iniciando login...');
                const result = await auth.signInWithPopup(googleProvider);
                console.log('‚úÖ Login realizado:', result.user.email);
            } catch (error) {
                console.error('‚ùå Erro no login:', error);
                showError('Erro no login: ' + error.message);
            }
        }

        async function logout() {
            try {
                await auth.signOut();
                console.log('‚úÖ Logout realizado');
                showLoginScreen();
            } catch (error) {
                console.error('Erro no logout:', error);
            }
        }

        // ========== GERENCIAMENTO DE TELAS ==========
        function showLoginScreen() {
            loginScreen.style.display = 'block';
            appHeader.style.display = 'none';
            loadingScreen.style.display = 'none';
            errorScreen.style.display = 'none';
            clientDataScreen.style.display = 'none';
        }

        function showLoadingScreen() {
            loginScreen.style.display = 'none';
            appHeader.style.display = 'flex';
            loadingScreen.style.display = 'block';
            errorScreen.style.display = 'none';
            clientDataScreen.style.display = 'none';
        }

        function showErrorScreen(message) {
            loginScreen.style.display = 'none';
            appHeader.style.display = 'flex';
            loadingScreen.style.display = 'none';
            errorScreen.style.display = 'block';
            clientDataScreen.style.display = 'none';
            errorMessage.textContent = message;
        }

        function showClientDataScreen() {
            loginScreen.style.display = 'none';
            appHeader.style.display = 'flex';
            loadingScreen.style.display = 'none';
            errorScreen.style.display = 'none';
            clientDataScreen.style.display = 'block';
        }

        // ========== CARREGAMENTO DE DADOS ==========
        async function loadClientData() {
            console.log('üîÑ Carregando dados do cliente...');
            showLoadingScreen();
            
            const user = auth.currentUser;
            if (!user) {
                showErrorScreen('Usu√°rio n√£o autenticado');
                return;
            }
            
            currentUserId = user.uid;
            console.log('üë§ Usu√°rio ID:', currentUserId);
            
            try {
                // 1. Verificar se √© admin
                await checkAdminStatus(user.uid);
                
                // 2. Tentar carregar dados do cliente
                console.log('üì• Buscando dados em "clients"...');
                const clientDoc = await db.collection('clients').doc(user.uid).get();
                
                if (!clientDoc.exists) {
                    console.log('üì≠ Cliente n√£o encontrado, criando perfil...');
                    await createBasicProfile(user);
                    await loadClientData(); // Recarrega ap√≥s criar
                    return;
                }
                
                const clientData = clientDoc.data();
                console.log('‚úÖ Dados carregados:', clientData);
                
                // 3. Preencher dados na tela
                populateClientData(clientData, user);
                
                // 4. Carregar telefones e emails
                await loadContactData(user.uid);
                
                // 5. Mostrar tela de dados
                showClientDataScreen();
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados:', error);
                handleFirestoreError(error);
            }
        }

        async function checkAdminStatus(userId) {
            try {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    isAdminUser = userData.isAdmin === true || 
                                  userId === "sZxfMuOBPbXdR8nttVPXIN8QOOl1";
                    
                    console.log('üëë √â admin?', isAdminUser);
                    
                    if (isAdminUser) {
                        userBadge.textContent = 'Administrador';
                        userBadge.className = 'badge badge-admin';
                    } else {
                        userBadge.textContent = 'Usu√°rio';
                        userBadge.className = 'badge badge-user';
                    }
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è N√£o foi poss√≠vel verificar admin:', error);
                isAdminUser = false;
            }
        }

        async function createBasicProfile(user) {
            try {
                console.log('üìù Criando perfil b√°sico...');
                
                const profileData = {
                    fullName: user.displayName || '',
                    email: user.email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    isActive: true,
                    isBanned: false
                };
                
                await db.collection('clients').doc(user.uid).set(profileData);
                console.log('‚úÖ Perfil criado com sucesso');
                
            } catch (error) {
                console.error('‚ùå Erro ao criar perfil:', error);
                throw error;
            }
        }

        function populateClientData(clientData, user) {
            // Informa√ß√µes b√°sicas
            document.getElementById('uidField').textContent = user.uid;
            document.getElementById('nameField').textContent = clientData.fullName || 'N√£o informado';
            document.getElementById('cpfField').textContent = formatCPF(clientData.cpf) || 'N√£o informado';
            document.getElementById('rgField').textContent = clientData.rg || 'N√£o informado';
            document.getElementById('socialNameField').textContent = clientData.socialName || 'N√£o informado';
            
            // Dados pessoais
            document.getElementById('birthDateField').textContent = formatDate(clientData.birthDate) || 'N√£o informado';
            document.getElementById('genderField').textContent = clientData.gender || 'N√£o informado';
            document.getElementById('createdAtField').textContent = formatDate(clientData.createdAt) || 'N√£o informado';
            document.getElementById('updatedAtField').textContent = formatDate(clientData.updatedAt) || 'N√£o informado';
            
            // Endere√ßo
            document.getElementById('addressField').textContent = clientData.address || 'N√£o informado';
            document.getElementById('zipCodeField').textContent = clientData.zipCode || 'N√£o informado';
            document.getElementById('cityStateField').textContent = [clientData.city, clientData.state].filter(Boolean).join(', ') || 'N√£o informado';
            document.getElementById('countryField').textContent = clientData.country || 'N√£o informado';
            
            // Email principal
            document.getElementById('emailField').textContent = clientData.email || user.email;
        }

        async function loadContactData(userId) {
            try {
                // Telefones
                const phonesSnapshot = await db.collection('clientPhones')
                    .where('clientId', '==', userId)
                    .get();
                
                const phones = phonesSnapshot.docs.map(doc => {
                    return formatPhone(doc.data().phoneNumber);
                }).join(', ');
                
                document.getElementById('phoneField').textContent = phones || 'N√£o informado';
                
            } catch (error) {
                console.warn('‚ö†Ô∏è Erro ao carregar contatos:', error);
                document.getElementById('phoneField').textContent = 'Erro ao carregar';
            }
        }

        // ========== MANIPULA√á√ÉO DE ERROS ==========
        function handleFirestoreError(error) {
            console.error('üî• Erro Firestore:', error.code, error.message);
            
            let userMessage = 'Erro desconhecido ao carregar dados.';
            
            switch (error.code) {
                case 'permission-denied':
                    userMessage = `
                        üîí <strong>Permiss√£o Negada</strong><br><br>
                        Suas credenciais n√£o permitem acesso aos dados.<br>
                        <em>Poss√≠veis causas:</em><br>
                        ‚Ä¢ Voc√™ n√£o est√° autenticado corretamente<br>
                        ‚Ä¢ Sua conta est√° banida<br>
                        ‚Ä¢ Regras de seguran√ßa bloqueiam o acesso<br><br>
                        <strong>Tente:</strong><br>
                        1. Fazer logout e login novamente<br>
                        2. Verificar se voc√™ tem acesso ao perfil<br>
                        3. Contactar um administrador
                    `;
                    break;
                    
                case 'not-found':
                    userMessage = 'Perfil n√£o encontrado. Clique em "Editar Perfil" para criar um.';
                    break;
                    
                default:
                    userMessage = `Erro: ${error.message}`;
            }
            
            showErrorScreen(userMessage);
        }

        // ========== FUN√á√ïES AUXILIARES ==========
        function formatDate(timestamp) {
            if (!timestamp) return null;
            try {
                const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
                return date.toLocaleDateString('pt-BR') + ' ' + 
                       date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            } catch (e) {
                return null;
            }
        }

        function formatCPF(cpf) {
            if (!cpf) return null;
            cpf = cpf.toString().replace(/\D/g, '');
            if (cpf.length === 11) {
                return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
            }
            return cpf;
        }

        function formatPhone(phone) {
            if (!phone) return null;
            phone = phone.toString().replace(/\D/g, '');
            if (phone.length === 11) {
                return phone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (phone.length === 10) {
                return phone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
            }
            return phone;
        }

        // ========== FUN√á√ïES DE INTERA√á√ÉO ==========
        function editProfile() {
            if (currentUserId) {
                window.location.href = `editar_cliente/?uid=${currentUserId}`;
            }
        }

        function refreshData() {
            loadClientData();
        }

        function debugFirebase() {
            console.clear();
            console.log('üîç === DEBUG FIREBASE ===');
            console.log('üë§ Usu√°rio:', auth.currentUser);
            console.log('üëë Admin?', isAdminUser);
            console.log('üìã UID:', currentUserId);
            
            // Testa permiss√µes
            testPermissions();
        }

        async function testPermissions() {
            console.log('\nüîí Testando permiss√µes...');
            
            const userId = auth.currentUser?.uid;
            if (!userId) {
                console.log('‚ùå Nenhum usu√°rio logado');
                return;
            }
            
            try {
                // Testa clients
                const clientTest = await db.collection('clients').doc(userId).get();
                console.log('‚úÖ clients:', clientTest.exists ? 'OK' : 'N√£o existe');
                
                // Testa clientPhones
                const phonesTest = await db.collection('clientPhones')
                    .where('clientId', '==', userId)
                    .limit(1)
                    .get();
                console.log('‚úÖ clientPhones:', phonesTest.empty ? 'Vazia' : 'OK');
                
                // Testa users
                const usersTest = await db.collection('users').doc(userId).get();
                console.log('‚úÖ users:', usersTest.exists ? 'OK' : 'N√£o existe');
                
            } catch (error) {
                console.error('‚ùå Erro no teste:', error.code, error.message);
            }
        }

        // ========== INICIALIZA√á√ÉO ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Aplica√ß√£o carregada');
            
            // Monitorar autentica√ß√£o
            auth.onAuthStateChanged((user) => {
                console.log('üîê Estado de autentica√ß√£o:', user ? 'Logado' : 'Deslogado');
                
                if (user) {
                    console.log('üë§ Usu√°rio logado:', user.email);
                    loadClientData();
                } else {
                    showLoginScreen();
                }
            });
        });
    </script>
</body>
</html>
