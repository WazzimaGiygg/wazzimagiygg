<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artigos Recentes - Wiki World Web</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --cor-fundo: #f0f2f5;
            --cor-container: #ffffff;
            --cor-texto-principal: #333333;
            --cor-texto-secundario: #666666;
            --cor-divisoria: #e0e0e0;
            --cor-destaque: #007bff;
            --cor-destaque-hover: #0056b3;
            --cor-perigo: #dc3545;
            --cor-sucesso: #28a745;
            --cor-info: #17a2b8;
            --cor-purple: #6f42c1;
            --cor-google: #DB4437;
            --sombra: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: var(--cor-fundo);
            color: var(--cor-texto-principal);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--cor-divisoria);
        }

        .header h1 {
            font-size: 2.5em;
            margin: 0 0 10px 0;
            color: var(--cor-texto-principal);
        }

        .header p {
            color: var(--cor-texto-secundario);
            font-size: 1.1em;
            margin: 0;
        }

        .recent-articles-panel {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--sombra);
        }

        .recent-articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .recent-article-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
            cursor: pointer;
        }

        .recent-article-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            border-color: var(--cor-destaque);
        }

        .recent-article-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .recent-article-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--cor-texto-principal);
            margin: 0;
            flex-grow: 1;
        }

        .recent-article-badge {
            background-color: var(--cor-info);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 500;
            margin-left: 10px;
        }

        .recent-article-collection {
            font-size: 0.9em;
            color: var(--cor-texto-secundario);
            margin-bottom: 10px;
        }

        .recent-article-excerpt {
            font-size: 0.95em;
            color: var(--cor-texto-principal);
            line-height: 1.5;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .recent-article-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85em;
            color: var(--cor-texto-secundario);
        }

        .recent-article-date {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .recent-article-access {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .collection-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .collection-btn {
            padding: 8px 16px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .collection-btn:hover {
            background-color: #e9ecef;
        }

        .collection-btn.active {
            background-color: var(--cor-destaque);
            color: white;
            border-color: var(--cor-destaque);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--cor-texto-secundario);
        }

        .loading::after {
            content: "...";
            animation: dots 1.5s steps(4, end) infinite;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--cor-texto-secundario);
        }

        .empty-state h3 {
            font-size: 1.5em;
            margin: 0 0 15px 0;
        }

        .empty-state p {
            margin: 0 0 25px 0;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        @keyframes dots {
            0%, 20% { content: "."; }
            40% { content: ".."; }
            60%, 100% { content: "..."; }
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            .container {
                max-width: 100%;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .recent-articles-grid {
                grid-template-columns: 1fr;
            }
            
            .collection-selector {
                flex-direction: column;
            }
            
            .collection-btn {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Cabe√ßalho -->
        <div class="header">
            <h1>üì∞ Artigos Recentes</h1>
            <p>Explore os artigos mais recentes de todas as cole√ß√µes</p>
        </div>

        <!-- Painel de Artigos Recentes -->
        <div id="recentArticlesPanel" class="recent-articles-panel">
            <div class="collection-selector" id="collectionSelector">
                <!-- Os bot√µes das cole√ß√µes ser√£o gerados dinamicamente -->
            </div>
            
            <div id="recentArticlesGrid" class="recent-articles-grid">
                <!-- Os artigos ser√£o carregados aqui -->
            </div>
            
            <div class="loading" id="recentLoading" style="display: none;">
                Carregando artigos recentes...
            </div>
        </div>
    </div>

    <script>
        // Configura√ß√£o do Firebase (simplificada para demonstra√ß√£o)
        const firebaseConfig = {
            apiKey: "AIzaSyB9GkSqTIZ0kbVsba_WOdQeVAETrF9qna0",
            authDomain: "wzzm-ce3fc.firebaseapp.com",
            projectId: "wzzm-ce3fc",
            storageBucket: "wzzm-ce3fc.appspot.com",
            messagingSenderId: "249427877153",
            appId: "1:249427877153:web:0e4297294794a5aadeb260",
            measurementId: "G-PLKNZNFCQ8"
        };

        // Inicializar Firebase (em um cen√°rio real, voc√™ inicializaria o Firebase aqui)
        // firebase.initializeApp(firebaseConfig);
        // const db = firebase.firestore();

        // Elementos da interface
        const recentArticlesPanel = document.getElementById('recentArticlesPanel');
        const recentArticlesGrid = document.getElementById('recentArticlesGrid');
        const collectionSelector = document.getElementById('collectionSelector');
        const recentLoading = document.getElementById('recentLoading');

        // Estado da aplica√ß√£o
        let currentCollectionFilter = 'todos';

        // Lista de cole√ß√µes dispon√≠veis (mock data para demonstra√ß√£o)
        const availableCollections = [
            { id: 'materiadeensaio', name: 'Material de Ensaio' },
            { id: 'wikiworldweb', name: 'Wiki World Web' },
            { id: 'materias', name: 'Mat√©rias' },
            { id: 'wikicodigo', name: 'Wiki C√≥digo' },
            { id: 'materia', name: 'Mat√©ria' },
            { id: 'academico', name: 'Acad√™mico' },
            { id: 'userpage', name: 'P√°gina de Usu√°rio' },
            { id: 'historicodecontribuicoes', name: 'Hist√≥rico de Contribui√ß√µes' }
        ];

        // Mapeamento de nomes de cole√ß√µes para exibi√ß√£o
        const collectionNames = {
            'materiadeensaio': 'Material de Ensaio',
            'wikiworldweb': 'Wiki World Web',
            'materias': 'Mat√©rias',
            'wikicodigo': 'Wiki C√≥digo',
            'materia': 'Mat√©ria',
            'academico': 'Acad√™mico',
            'userpage': 'P√°gina de Usu√°rio',
            'historicodecontribuicoes': 'Hist√≥rico de Contribui√ß√µes'
        };

        // Dados de exemplo para demonstra√ß√£o (em um cen√°rio real, viriam do Firebase)
        const mockArticles = [
            {
                id: 'artigo001',
                collection: 'wikiworldweb',
                titulo: 'Introdu√ß√£o ao Desenvolvimento Web',
                descricao: 'Um guia completo para iniciantes no desenvolvimento web, cobrindo HTML, CSS e JavaScript b√°sicos.',
                restrito: false,
                criadoEm: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)
            },
            {
                id: 'artigo002',
                collection: 'materiadeensaio',
                titulo: 'T√©cnicas de Teste de Software',
                descricao: 'Metodologias e pr√°ticas recomendadas para testes de software em diferentes ambientes.',
                restrito: true,
                criadoEm: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000)
            },
            {
                id: 'artigo003',
                collection: 'wikicodigo',
                titulo: 'Padr√µes de Projeto em JavaScript',
                descricao: 'Implementa√ß√£o dos principais padr√µes de projeto usando JavaScript moderno.',
                restrito: false,
                criadoEm: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 6 * 60 * 60 * 1000)
            },
            {
                id: 'artigo004',
                collection: 'academico',
                titulo: 'Pesquisa em Intelig√™ncia Artificial',
                descricao: 'An√°lise das tend√™ncias atuais em pesquisa de IA e machine learning.',
                restrito: false,
                criadoEm: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000)
            },
            {
                id: 'artigo005',
                collection: 'materias',
                titulo: 'Hist√≥ria da Computa√ß√£o',
                descricao: 'Uma linha do tempo dos principais eventos no desenvolvimento da computa√ß√£o.',
                restrito: false,
                criadoEm: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000)
            },
            {
                id: 'user123',
                collection: 'userpage',
                titulo: 'Perfil de Jo√£o Silva',
                descricao: 'Desenvolvedor full-stack com 5 anos de experi√™ncia em tecnologias web.',
                restrito: true,
                criadoEm: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),
                atualizadoEm: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
            }
        ];

        // Criar seletor de cole√ß√µes
        function createCollectionSelector() {
            collectionSelector.innerHTML = '';
            
            // Adicionar bot√£o "Todas"
            const allButton = document.createElement('button');
            allButton.className = `collection-btn ${currentCollectionFilter === 'todos' ? 'active' : ''}`;
            allButton.textContent = 'Todas as Cole√ß√µes';
            allButton.onclick = () => {
                currentCollectionFilter = 'todos';
                loadRecentArticles();
                updateCollectionButtons();
            };
            collectionSelector.appendChild(allButton);
            
            // Adicionar bot√µes para cada cole√ß√£o
            availableCollections.forEach(collection => {
                const button = document.createElement('button');
                button.className = `collection-btn ${currentCollectionFilter === collection.id ? 'active' : ''}`;
                button.textContent = collection.name;
                button.onclick = () => {
                    currentCollectionFilter = collection.id;
                    loadRecentArticles();
                    updateCollectionButtons();
                };
                collectionSelector.appendChild(button);
            });
        }

        // Atualizar estado dos bot√µes de cole√ß√£o
        function updateCollectionButtons() {
            const buttons = collectionSelector.querySelectorAll('.collection-btn');
            buttons.forEach(button => {
                button.classList.remove('active');
                
                if (currentCollectionFilter === 'todos' && button.textContent === 'Todas as Cole√ß√µes') {
                    button.classList.add('active');
                } else if (button.textContent === collectionNames[currentCollectionFilter]) {
                    button.classList.add('active');
                }
            });
        }

        // Carregar artigos recentes (vers√£o mock)
        async function loadRecentArticles() {
            recentArticlesGrid.innerHTML = '';
            recentLoading.style.display = 'block';
            
            try {
                // Em um cen√°rio real, voc√™ buscaria do Firebase aqui
                // Por enquanto, usamos dados mockados
                await new Promise(resolve => setTimeout(resolve, 500)); // Simular delay de rede
                
                // Filtrar artigos baseado na cole√ß√£o selecionada
                let filteredArticles = mockArticles;
                if (currentCollectionFilter !== 'todos') {
                    filteredArticles = mockArticles.filter(article => 
                        article.collection === currentCollectionFilter
                    );
                }
                
                // Ordenar por data (mais recente primeiro)
                filteredArticles.sort((a, b) => {
                    const dateA = a.atualizadoEm || a.criadoEm;
                    const dateB = b.atualizadoEm || b.criadoEm;
                    return dateB - dateA;
                });
                
                // Exibir artigos
                displayRecentArticles(filteredArticles);
                
            } catch (error) {
                console.error('Erro ao carregar artigos recentes:', error);
                recentArticlesGrid.innerHTML = `
                    <div class="empty-state">
                        <h3>Erro ao carregar artigos</h3>
                        <p>N√£o foi poss√≠vel carregar os artigos. Tente novamente mais tarde.</p>
                    </div>
                `;
            } finally {
                recentLoading.style.display = 'none';
            }
        }

        // Exibir artigos recentes na grade
        function displayRecentArticles(articles) {
            if (articles.length === 0) {
                recentArticlesGrid.innerHTML = `
                    <div class="empty-state">
                        <h3>Nenhum artigo encontrado</h3>
                        <p>N√£o h√° artigos para exibir na cole√ß√£o "${currentCollectionFilter === 'todos' ? 'Todas as Cole√ß√µes' : collectionNames[currentCollectionFilter]}".</p>
                    </div>
                `;
                return;
            }
            
            let articlesHtml = '';
            
            articles.forEach(article => {
                const date = article.atualizadoEm ? formatDate(article.atualizadoEm) : 
                            article.criadoEm ? formatDate(article.criadoEm) : 'Data desconhecida';
                const excerpt = article.descricao 
                    ? (article.descricao.length > 150 ? article.descricao.substring(0, 150) + '...' : article.descricao)
                    : 'Sem descri√ß√£o dispon√≠vel';
                
                articlesHtml += `
                    <div class="recent-article-card" onclick="loadArticle('${article.id}', '${article.collection}')">
                        <div class="recent-article-header">
                            <h3 class="recent-article-title">${article.titulo || 'Artigo sem t√≠tulo'}</h3>
                            ${article.restrito ? '<span class="recent-article-badge">üîí Restrito</span>' : ''}
                        </div>
                        <div class="recent-article-collection">
                            <i class="fas fa-folder"></i> ${collectionNames[article.collection] || article.collection}
                        </div>
                        <div class="recent-article-excerpt">
                            ${excerpt}
                        </div>
                        <div class="recent-article-meta">
                            <div class="recent-article-date">
                                <i class="far fa-calendar"></i> ${date}
                            </div>
                            <div class="recent-article-access">
                                ${article.restrito ? '<i class="fas fa-lock"></i> Restrito' : '<i class="fas fa-unlock"></i> P√∫blico'}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            recentArticlesGrid.innerHTML = articlesHtml;
        }

        // Fun√ß√£o para carregar artigo (simulada)
        function loadArticle(uid, collection) {
            alert(`Artigo carregado!\nUID: ${uid}\nCole√ß√£o: ${collection}\n\nEm um sistema completo, este artigo seria carregado para visualiza√ß√£o.`);
            // Em um sistema completo, voc√™ redirecionaria para a p√°gina de visualiza√ß√£o
            // ou carregaria o artigo no mesmo contexto
        }

        // Fun√ß√£o para formatar data
        function formatDate(date) {
            if (!date) return 'N/A';
            try {
                const d = new Date(date);
                return d.toLocaleDateString('pt-BR') + ' ' + d.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            } catch (e) {
                return 'Data inv√°lida';
            }
        }

        // Inicializar a p√°gina
        window.onload = function() {
            console.log('Visualiza√ß√£o de Artigos Recentes carregada');
            createCollectionSelector();
            loadRecentArticles();
            
            // Tornar fun√ß√µes globais se necess√°rio
            window.loadArticle = loadArticle;
        };
    </script>
</body>
</html>
