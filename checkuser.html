<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labirinto Desafio de Acesso</title>
    
    <style>
        :root {
            /* Vari√°veis de cor padr√£o para o tema 1 */
            --bg-color: #282c34;
            --border-color: #61dafb;
            --wall-color: #61dafb;
            --path-color: #333;
            --player-color: #e0b0ff;
            --start-color: #4CAF50;
            --start-border-color: #388E3C;
            --end-color: #f44336;
            --end-border-color: #D32F2F;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: var(--bg-color);
            color: white;
            font-family: Arial, sans-serif;
        }

        h1 {
            margin-bottom: 20px;
        }

        #game-container {
            position: relative;
            border: 2px solid var(--border-color);
            overflow: hidden;
            background-color: var(--path-color);
            box-sizing: content-box; /* Garante que o padding/borda n√£o afete as dimens√µes do grid */
        }

        #maze {
            display: grid;
            background-color: var(--path-color);
        }

        .wall {
            background-color: var(--wall-color);
        }

        .path {
            background-color: var(--path-color);
        }

        #player {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: var(--player-color);
            border-radius: 50%;
            transition: left 0.05s linear, top 0.05s linear;
        }

        #start-point, #end-point {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            box-sizing: border-box;
        }

        #start-point {
            background-color: var(--start-color);
            border: 2px solid var(--start-border-color);
        }

        #end-point {
            background-color: var(--end-color);
            border: 2px solid var(--end-border-color);
        }

        #info {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        #info p {
            font-size: 1.2em;
            margin: 0;
        }

        .buttons-container {
            display: flex;
            gap: 15px;
        }

        button {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Labirinto Desafio de Acesso</h1>
    <div id="game-container">
        <div id="maze"></div>
        <div id="player"></div>
        <div id="start-point"></div>
        <div id="end-point"></div>
    </div>
    <div id="info">
        <p>Fase: <span id="level">1</span></p>
        <p>Tempo: <span id="time">00:00</span></p>
        <div class="buttons-container">
            <button id="restart-button">Reiniciar</button>
            <button id="next-level-button" style="display: none;">Pr√≥xima Fase</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const URL_DE_REDIRECIONAMENTO = 'https://wazzimagiygg.com/wikinotpedia.html';
            const FASES_NECESSARIAS = 3; // O n√∫mero de fases que o jogador precisa completar
            
            const mazeContainer = document.getElementById('maze');
            const player = document.getElementById('player');
            const startPoint = document.getElementById('start-point');
            const endPoint = document.getElementById('end-point');
            const timeDisplay = document.getElementById('time');
            const levelDisplay = document.getElementById('level');
            const restartButton = document.getElementById('restart-button');
            const nextLevelButton = document.getElementById('next-level-button');

            const cellSize = 20; // Tamanho de cada c√©lula em pixels

            let maze = [];
            let numRows, numCols;
            let playerPos = { x: 0, y: 0 };
            let startPos = { x: 0, y: 0 };
            let endPos = { x: 0, y: 0 };

            let startTime;
            let timerInterval;
            let gameActive = false;
            let currentLevel = 1;

            // Configura√ß√µes de cores para diferentes temas
            const colorThemes = [
                { // Tema 1: Azul Ciano (Padr√£o)
                    '--bg-color': '#282c34',
                    '--border-color': '#61dafb',
                    '--wall-color': '#61dafb',
                    '--path-color': '#333',
                    '--player-color': '#e0b0ff',
                    '--start-color': '#4CAF50',
                    '--start-border-color': '#388E3C',
                    '--end-color': '#f44336',
                    '--end-border-color': '#D32F2F',
                },
                { // Tema 2: Verde Floresta
                    '--bg-color': '#224036',
                    '--border-color': '#6cc091',
                    '--wall-color': '#6cc091',
                    '--path-color': '#1a2a22',
                    '--player-color': '#d1f0c4',
                    '--start-color': '#A5D6A7',
                    '--start-border-color': '#66BB6A',
                    '--end-color': '#FF8A65',
                    '--end-border-color': '#FF5722',
                },
                { // Tema 3: Roxo Escuro
                    '--bg-color': '#3a2b4f',
                    '--border-color': '#9b59b6',
                    '--wall-color': '#9b59b6',
                    '--path-color': '#281d3a',
                    '--player-color': '#f3e5f5',
                    '--start-color': '#81C784',
                    '--start-border-color': '#4CAF50',
                    '--end-color': '#EF9A9A',
                    '--end-border-color': '#E57373',
                },
                { // Tema 4: Laranja P√¥r do Sol
                    '--bg-color': '#4d392b',
                    '--border-color': '#ffa726',
                    '--wall-color': '#ffa726',
                    '--path-color': '#382a1f',
                    '--player-color': '#ffe0b2',
                    '--start-color': '#FFD54F',
                    '--start-border-color': '#FFC107',
                    '--end-color': '#FF7043',
                    '--end-border-color': '#F4511E',
                }
            ];

            // --- Algoritmo de Gera√ß√£o de Labirinto (DFS) ---
            function generateMaze(rows, cols) {
                numRows = rows % 2 === 0 ? rows + 1 : rows;
                numCols = cols % 2 === 0 ? cols + 1 : cols;

                const newMaze = Array(numRows).fill(0).map(() => Array(numCols).fill(1));

                let startRow = 1;
                let startCol = 1;

                const stack = [[startRow, startCol]];
                newMaze[startRow][startCol] = 0;

                while (stack.length > 0) {
                    const [currentRow, currentCol] = stack[stack.length - 1];

                    const neighbors = [];
                    // Cima
                    if (currentRow - 2 > 0 && newMaze[currentRow - 2][currentCol] === 1) {
                        neighbors.push([currentRow - 2, currentCol]);
                    }
                    // Baixo
                    if (currentRow + 2 < numRows - 1 && newMaze[currentRow + 2][currentCol] === 1) {
                        neighbors.push([currentRow + 2, currentCol]);
                    }
                    // Esquerda
                    if (currentCol - 2 > 0 && newMaze[currentRow][currentCol - 2] === 1) {
                        neighbors.push([currentRow, currentCol - 2]);
                    }
                    // Direita
                    if (currentCol + 2 < numCols - 1 && newMaze[currentRow][currentCol + 2] === 1) {
                        neighbors.push([currentRow, currentCol + 2]);
                    }

                    if (neighbors.length > 0) {
                        const [nextRow, nextCol] = neighbors[Math.floor(Math.random() * neighbors.length)];

                        newMaze[nextRow][nextCol] = 0;
                        newMaze[currentRow + (nextRow - currentRow) / 2][currentCol + (nextCol - currentCol) / 2] = 0;

                        stack.push([nextRow, nextCol]);
                    } else {
                        stack.pop();
                    }
                }

                startPos = { x: 1, y: 1 };
                newMaze[startPos.y][startPos.x] = 0;

                let foundEnd = false;
                while (!foundEnd) {
                    const randY = Math.floor(Math.random() * (numRows - 2)) + 1;
                    const randX = Math.floor(Math.random() * (numCols - 2)) + 1;

                    if (newMaze[randY][randX] === 0 && (Math.abs(randY - startPos.y) + Math.abs(randX - startPos.x)) > (numRows + numCols) / 4) {
                        endPos = { x: randX, y: randY };
                        foundEnd = true;
                    }
                }
                newMaze[endPos.y][endPos.x] = 0;

                return newMaze;
            }

            // Aplica o tema de cores ao DOM
            function applyColorTheme(theme) {
                const root = document.documentElement;
                for (const [prop, value] of Object.entries(theme)) {
                    root.style.setProperty(prop, value);
                }
            }

            // Cria o labirinto no HTML
            function drawMaze() {
                mazeContainer.innerHTML = '';
                mazeContainer.style.gridTemplateColumns = `repeat(${numCols}, ${cellSize}px)`;
                mazeContainer.style.gridTemplateRows = `repeat(${numRows}, ${cellSize}px)`;

                for (let row = 0; row < numRows; row++) {
                    for (let col = 0; col < numCols; col++) {
                        const cell = document.createElement('div');
                        cell.classList.add(maze[row][col] === 1 ? 'wall' : 'path');
                        mazeContainer.appendChild(cell);
                    }
                }

                // Posiciona o ponto de in√≠cio
                startPoint.style.left = `${startPos.x * cellSize}px`;
                startPoint.style.top = `${startPos.y * cellSize}px`;
                startPoint.style.width = `${cellSize}px`;
                startPoint.style.height = `${cellSize}px`;
                startPoint.textContent = 'In√≠cio';
                startPoint.style.fontSize = `${cellSize * 0.4}px`;
                startPoint.style.lineHeight = `${cellSize}px`;

                // Posiciona o ponto final
                endPoint.style.left = `${endPos.x * cellSize}px`;
                endPoint.style.top = `${endPos.y * cellSize}px`;
                endPoint.style.width = `${cellSize}px`;
                endPoint.style.height = `${cellSize}px`;
                endPoint.textContent = 'Fim';
                endPoint.style.fontSize = `${cellSize * 0.4}px`;
                endPoint.style.lineHeight = `${cellSize}px`;
            }

            // Atualiza a posi√ß√£o visual do jogador
            function updatePlayerPosition() {
                player.style.left = `${playerPos.x * cellSize}px`;
                player.style.top = `${playerPos.y * cellSize}px`;
            }

            // Inicia o contador de tempo
            function startTimer() {
                startTime = Date.now();
                timerInterval = setInterval(() => {
                    const elapsedTime = Date.now() - startTime;
                    const minutes = Math.floor(elapsedTime / 60000);
                    const seconds = Math.floor((elapsedTime % 60000) / 1000);
                    timeDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                }, 1000);
            }

            // Para o contador de tempo
            function stopTimer() {
                clearInterval(timerInterval);
            }

            // Verifica se a nova posi√ß√£o √© v√°lida (n√£o √© uma parede)
            function isValidMove(x, y) {
                return x >= 0 && x < numCols && y >= 0 && y < numRows && maze[y][x] === 0;
            }

            // Lida com a movimenta√ß√£o do jogador
            function handleKeyDown(event) {
                if (!gameActive) return;

                let newX = playerPos.x;
                let newY = playerPos.y;

                switch (event.key) {
                    case 'ArrowUp':
                        newY--;
                        break;
                    case 'ArrowDown':
                        newY++;
                        break;
                    case 'ArrowLeft':
                        newX--;
                        break;
                    case 'ArrowRight':
                        newX++;
                        break;
                    default:
                        return;
                }
                
                // Impede o scroll da p√°gina com as setas
                if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)) {
                    event.preventDefault();
                }

                if (isValidMove(newX, newY)) {
                    playerPos.x = newX;
                    playerPos.y = newY;
                    updatePlayerPosition();
                    checkWin();
                }
            }

            // Verifica se o jogador chegou ao final E gerencia o redirecionamento
          // Verifica se o jogador chegou ao final E gerencia o redirecionamento
            function checkWin() {
                if (playerPos.x === endPos.x && playerPos.y === endPos.y) {
                    stopTimer();
                    gameActive = false;
                    
                    // --- L√ìGICA DE DESAFIO/REDIRECIONAMENTO ---
                    if (currentLevel < FASES_NECESSARIAS) {
                        // ... (L√≥gica para ir para a pr√≥xima fase)
                    } else {
                        // √öLTIMA FASE CONCLU√çDA! Aciona o redirecionamento.
                        alert(`üéâ Desafio Conclu√≠do! Voc√™ completou as ${FASES_NECESSARIAS} fases. Redirecionando para a p√°gina secreta...`);
                        
                        // ... (Esconde bot√µes)
                        
                        // Redireciona com um pequeno atraso (2 segundos)
                        setTimeout(() => {
                            // AQUI est√° o redirecionamento para o seu arquivo
                            window.location.href = URL_DE_REDIRECIONAMENTO; 
                        }, 2000); 
                    }
                }
            }

            // Inicia uma nova fase
            function startNewLevel() {
                currentLevel++;
                levelDisplay.textContent = currentLevel;

                // Aumenta o tamanho do labirinto a cada fase (torna o desafio maior)
                let mazeRows = 15 + (currentLevel - 1) * 2;
                let mazeCols = 25 + (currentLevel - 1) * 2;

                mazeRows = mazeRows % 2 === 0 ? mazeRows + 1 : mazeRows;
                mazeCols = mazeCols % 2 === 0 ? mazeCols + 1 : mazeCols;

                maze = generateMaze(mazeRows, mazeCols);
                drawMaze();

                playerPos = { ...startPos };
                updatePlayerPosition();

                // Ajusta o tamanho do container do jogo
                document.getElementById('game-container').style.width = `${numCols * cellSize}px`;
                document.getElementById('game-container').style.height = `${numRows * cellSize}px`;

                // Aplica um tema de cor aleat√≥rio
                const randomThemeIndex = Math.floor(Math.random() * colorThemes.length);
                applyColorTheme(colorThemes[randomThemeIndex]);

                timeDisplay.textContent = '00:00';
                gameActive = true;
                
                // Verifica se estamos na √∫ltima fase e muda o texto do bot√£o "Pr√≥xima Fase"
                if (currentLevel === FASES_NECESSARIAS) {
                    nextLevelButton.textContent = 'Concluir Desafio';
                } else {
                    nextLevelButton.textContent = 'Pr√≥xima Fase';
                }
                
                startTimer();
                nextLevelButton.style.display = 'none'; // Esconde o bot√£o de pr√≥xima fase
            }

            // Reinicia o jogo (vai para a fase 1)
            function restartGame() {
                stopTimer();
                currentLevel = 0; // Ser√° incrementado para 1 em startNewLevel
                startNewLevel();
            }

            // Event Listeners
            document.addEventListener('keydown', handleKeyDown);
            restartButton.addEventListener('click', restartGame);
            nextLevelButton.addEventListener('click', startNewLevel);

            // Inicializa√ß√£o do jogo
            initGame();

            function initGame() {
                restartGame(); // Inicia a primeira fase
            }
        });
    </script>
</body>
</html>
