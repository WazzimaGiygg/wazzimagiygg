<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  Â  <meta charset="UTF-8" />
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  Â  <title>Wiki Not Pedia WZZM</title>
Â  Â  <link rel="icon" href="favicom.png" type="image/x-icon">
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  /* SEU PLANO DE FUNDO ESTÃ DEFINIDO AQUI: */
Â  Â  Â  Â  Â  Â  background: url('condedmonddantÃ¨s.png') center/cover no-repeat;
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', sans-serif;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Barra de tarefas */
Â  Â  Â  Â  .taskbar {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  background: rgba(20, 20, 20, 0.8);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  /* Adicionado espaÃ§o entre elementos na taskbar */
Â  Â  Â  Â  Â  Â  justify-content: space-between;Â 
Â  Â  Â  Â  Â  Â  padding: 0 10px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Container dos botÃµes Iniciar, Admin e Ferramentas */
Â  Â  Â  Â  .taskbar-left { /* Alterado para incluir o novo botÃ£o */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Estilo para o relÃ³gio na direita */
Â  Â  Â  Â  #clock {
Â  Â  Â  Â  Â  Â  padding: 0 10px;
Â  Â  Â  Â  Â  Â  text-align: right;
Â  Â  Â  Â  Â  Â  line-height: 1.2;
Â  Â  Â  Â  Â  Â  font-size: 0.85em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .start-button {
Â  Â  Â  Â  Â  Â  background: rgba(40, 40, 40, 0.9);
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 5px 15px;
Â  Â  Â  Â  Â  Â  margin-right: 10px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 40px;
Â  Â  Â  Â  Â  Â  left: 10px;
Â  Â  Â  Â  Â  Â  background: rgba(30, 30, 30, 0.95);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  width: 280px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-item {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  padding: 6px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-item:hover {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.15);
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-item img {
Â  Â  Â  Â  Â  Â  width: 20px;
Â  Â  Â  Â  Â  Â  height: 20px;
Â  Â  Â  Â  Â  Â  margin-right: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .window {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 60px;
Â  Â  Â  Â  Â  Â  left: 60px;
Â  Â  Â  Â  Â  Â  width: 800px;
Â  Â  Â  Â  Â  Â  height: 500px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border: 1px solid #666;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  resize: both;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  z-index: 100; /* Garante que a janela fique sobre os menus */
Â  Â  Â  Â  }

Â  Â  Â  Â  .window-header {
Â  Â  Â  Â  Â  Â  background: #0078d7;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 6px 10px;
Â  Â  Â  Â  Â  Â  cursor: move;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .window-controls button {
Â  Â  Â  Â  Â  Â  background: transparent;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  margin-left: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .window iframe {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Tela de login */
Â  Â  Â  Â  #login-screen {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0.8);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  z-index: 9999;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-screen h2 {
Â  Â  Â  Â  Â  Â  /* TÃ­tulo alterado no HTML */
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-screen p {
Â  Â  Â  Â  Â  Â  /* ParÃ¡grafo alterado no HTML */
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-screen button {
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  background: #0078d7;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Popup admin e novo popup ferramentas */
Â  Â  Â  Â  .admin-popup, .tools-popup { /* Adicionado .tools-popup */
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 50px;
Â  Â  Â  Â  Â  Â  /* Ajuste o left para posicionar os menus de forma coerente */
Â  Â  Â  Â  Â  Â  left: 100px; /* SerÃ¡ ajustado para o tools-popup no JS */
Â  Â  Â  Â  Â  Â  width: 320px;
Â  Â  Â  Â  Â  Â  background: rgba(40, 40, 40, 0.95);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* NOVO: Estilo para o menu de ferramentas para garantir que os links se pareÃ§am com itens de menu */
Â  Â  Â  Â  .tools-popup a {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 6px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  text-decoration: none;
Â  Â  Â  Â  Â  Â  margin-bottom: 2px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tools-popup a:hover {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.15);
Â  Â  Â  Â  }
Â  Â  Â  Â  .taskbar-right {
Â  Â  display: flex; /* Permite alinhar o Ã­cone e o relÃ³gio */
Â  Â  align-items: center;
}

/* Estilo para o Ãcone de NotificaÃ§Ã£o */
#notificationIcon {
Â  Â  cursor: pointer;
Â  Â  font-size: 1.2em; /* Tamanho do Ã­cone (pode ser um ğŸ”” ou outro caractere) */
Â  Â  margin-right: 15px; /* EspaÃ§o entre o Ã­cone e o relÃ³gio */
Â  Â  transition: color 0.2s;
Â  Â  color: white;
}

#notificationIcon:hover {
Â  Â  color: #0078d7;
}

/* NOVO: Estilo para o Popup de NotificaÃ§Ãµes */
#notificationPopup {
Â  Â  position: absolute;
Â  Â  bottom: 40px; /* Acima da taskbar */
Â  Â  right: 10px; /* Alinhado Ã  direita, prÃ³ximo ao relÃ³gio */
Â  Â  width: 300px;
Â  Â  max-height: 400px;
Â  Â  overflow-y: auto;
Â  Â  background: rgba(30, 30, 30, 0.95);
Â  Â  color: white;
Â  Â  border-radius: 8px;
Â  Â  padding: 10px;
Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
Â  Â  display: none; /* Escondido por padrÃ£o */
Â  Â  z-index: 101; /* Fica acima de outros menus (101 > 100) */
}

.notification-item {
Â  Â  padding: 8px;
Â  Â  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
Â  Â  margin-bottom: 5px;
}

.notification-item strong {
Â  Â  color: #4CAF50; /* Cor verde para destaque, ou vermelha para alerta */
}

/* Estilo para a NotificaÃ§Ã£o de SanÃ§Ã£o */
.sancao-alerta {
Â  Â  background-color: #cc0000;
Â  Â  padding: 10px;
Â  Â  border-radius: 5px;
Â  Â  font-weight: bold;
Â  Â  margin-bottom: 10px;
Â  Â  color: white;
}
Â  Â  </style>
</head>
<body>

Â  Â  <div id="login-screen">
Â  Â  Â  Â  <h2>Bem-vindo(a) ao Wiki Not Pedia WZZM</h2>
Â  Â  Â  Â  <p>FaÃ§a login para acessar a Ã¡rea de trabalho</p>
Â  Â  Â  Â  <button id="loginBtn">Entrar com Google</button>
Â  Â  </div>

Â  Â  <div id="desktop">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="taskbar">
Â  Â  Â  Â  Â  Â  <div class="taskbar-left">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="start-button" id="startBtn">Iniciar</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="start-button" id="adminBtn">Wiki Not PÃ©dia</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="start-button" id="toolsBtn">Ferramentas</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="taskbar-right">Â 
Â  Â  Â  Â  Â  Â  Â  Â  <span id="notificationIcon">ğŸ””</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="clock"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="menu" id="startMenu"></div>
Â  Â  Â  Â  <div class="admin-popup" id="adminMenu"></div>
Â  Â  Â  Â  <div class="admin-popup tools-popup" id="toolsMenu"></div>

Â  Â  Â  Â  <div id="notificationPopup"></div>
Â  Â  </div>

Â  Â <script type="module">
// ğŸ”¹ Firebase Auth & Firestore Config
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

const firebaseConfig = {
Â  Â  apiKey: "AIzaSyB9GkSqTIZ0kbVsba_WOdQeVAETrF9qna0", // Chave de API, mantenha a sua real
Â  Â  authDomain: "wzzm-ce3fc.firebaseapp.com",
Â  Â  projectId: "wzzm-ce3fc",
Â  Â  storageBucket: "wzzm-ce3fc.appspot.com",
Â  Â  messagingSenderId: "249427877153",
Â  Â  appId: "1:249427877153:web:0e4297294794a5aadeb260",
Â  Â  measurementId: "G-PLKNZNFCQ8"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

// CONSTANTES DO FIRESTORE
const KEY_ARRAY_FIELD = "itens_menu"; // Nome do campo ARRAY dentro do documento

// CONSTANTES DE ELEMENTOS
const notificationIcon = document.getElementById("notificationIcon");
const notificationPopup = document.getElementById("notificationPopup");
const JSON_URL = 'cidades_sancionadas.json';Â 

const loginScreen = document.getElementById("login-screen");
const loginBtn = document.getElementById("loginBtn");
const desktop = document.getElementById("desktop");
const startMenu = document.getElementById("startMenu");
const adminMenu = document.getElementById("adminMenu");
const toolsMenu = document.getElementById("toolsMenu");
const clockElement = document.getElementById("clock");

// BOTOES DA TASKBAR
const startBtn = document.getElementById("startBtn");
const adminBtn = document.getElementById("adminBtn");
const toolsBtn = document.getElementById("toolsBtn");

// âŒ REMOVIDAS: VariÃ¡veis de tabela que pertencem a 'visualizar-sancoes.html'

loginBtn.addEventListener("click", () => {
Â  Â  signInWithPopup(auth, provider);
});

// ğŸ“Œ LÃ³gica de clique do Ã­cone, fechando os outros menus.
notificationIcon.onclick = () => {
Â  Â  const isVisible = notificationPopup.style.display === "block";
Â  Â  startMenu.style.display = "none";
Â  Â  adminMenu.style.display = "none";
Â  Â  toolsMenu.style.display = "none";
Â  Â  notificationPopup.style.display = isVisible ? "none" : "block";
};

// âœ… LÃ³gica Alterada: Qualquer usuÃ¡rio logado (user) terÃ¡ acesso
onAuthStateChanged(auth, (user) => {
Â  Â  if (user) {
Â  Â  Â  Â  loginScreen.style.display = "none";
Â  Â  Â  Â  desktop.style.display = "block";
Â  Â  Â  Â  updateClock();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ğŸ†• CHAMA A FUNÃ‡ÃƒO DE CARREGAMENTO DE LINKS DO FIRESTORE
Â  Â  Â  Â  loadDynamicLinks(user.uid);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ğŸ“Œ AJUSTE 2: Chama a funÃ§Ã£o para buscar IP e verificar sanÃ§Ã£o aqui, APÃ“S o login.
Â  Â  Â  Â  buscarIpELocalizacao();
Â  Â  } else {
Â  Â  Â  Â  loginScreen.style.display = "flex";
Â  Â  Â  Â  desktop.style.display = "none";
Â  Â  Â  Â  notificationPopup.innerHTML = '';
Â  Â  Â  Â  notificationIcon.style.color = 'white';
Â  Â  }
});

// âŒ REMOVIDA: A funÃ§Ã£o carregarSancoes() e sua chamada, pois pertencem a 'visualizar-sancoes.html'.


// -------------------------------------------------------------
// ğŸš€ NOVA FUNÃ‡ÃƒO: CARREGA OS LINKS DO FIRESTORE E MONTA O MENU
// -------------------------------------------------------------
async function loadDynamicLinks(userId) {
Â  Â  try {
Â  Â  Â  Â  const SITE_ID = "wazzimagiygg"; // Defina o ID do site
Â  Â  Â  Â  const KEY_DOCUMENT_ID = `${SITE_ID}_menu_list`; // Ex: 'wazzimagiygg_menu_list'
Â  Â  Â  Â  const docRef = doc(db, "keymenulista", KEY_DOCUMENT_ID);
Â  Â  Â  Â  const docSnap = await getDoc(docRef);

Â  Â  Â  Â  let allLinksFromDB = []; // Todos os links dinÃ¢micos do Firebase

Â  Â  Â  Â  if (docSnap.exists()) {
Â  Â  Â  Â  Â  Â  const data = docSnap.data();
Â  Â  Â  Â  Â  Â  if (data[KEY_ARRAY_FIELD] && Array.isArray(data[KEY_ARRAY_FIELD])) {
Â  Â  Â  Â  Â  Â  Â  Â  // Mapeia os dados do Firebase
Â  Â  Â  Â  Â  Â  Â  Â  allLinksFromDB = data[KEY_ARRAY_FIELD].map(item => ({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: item.titulo,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  url: item.link_url,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconUrl: item.url_imagem || 'iconmagic.png',Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  menu_target: item.menu_target || 'outros'Â 
Â  Â  Â  Â  Â  Â  Â  Â  }));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // 1. FILTRAGEM DOS LINKS DINÃ‚MICOS POR CATEGORIA (menu_target)
Â  Â  Â  Â  const linksParaIniciar = allLinksFromDB.filter(item => item.menu_target === 'menu_iniciar');
Â  Â  Â  Â  const linksParaAdmin = allLinksFromDB.filter(item => item.menu_target === 'wiki_pedia');
Â  Â  Â  Â  const linksParaFerramentas = allLinksFromDB.filter(item => item.menu_target === 'ferramentas');

Â  Â  Â  Â  // 2. LINKS ESTÃTICOS
Â  Â  Â  Â  const staticStartLinks = [
Â  Â  Â  Â  Â  Â  { name: 'Termos de ServiÃ§o', url: 'Termos%20de%20Servi%C3%A7o.pdf', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },
Â  Â  Â  Â  Â  Â  { name: 'PolÃ­tica de Privacidade', url: 'Pol%C3%ADtica%20de%20Privacidade.pdf', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },
Â  Â  Â  Â  Â  Â  { name: 'Fale com a AdministraÃ§Ã£o', url: 'html/?uid=a13IwrEoc1Jmdi2I3Hve', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },Â 
Â  Â  Â  Â  Â  Â  { name: 'Gerenciador GESPAI', url: 'https://wazzimagiygg.com/gespai/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },//ciphersafe.wazzimagiygg.com
Â  Â  Â  Â  Â  Â  //{ name: 'quill-sync', url: 'https://quill-sync.wazzimagiygg.com/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },//https://quill-sync.wazzimagiygg.com/
Â  Â  Â  Â  Â  Â  Â  Â  { name: 'Logoff (Sair)', action: 'logout', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' }

Â  Â  Â  Â  ]; //https://vimeo.com/user157082307

Â  Â  Â  Â  const staticAdminLinks = [
Â  Â  Â  Â  Â  Â  { name: "Criar um artigo (de ensaio para aprovaÃ§Ã£o) ", url: "areadeensaiodeartigos.html", menu_target: 'wiki_pedia' }, //https://jsonmulti-tabviewer.wazzimagiygg.com/
            { name: "Visualizar Cidades Sancionadas", url: "visualizar-sancoes.html", iconUrl: 'iconmagic.png', menu_target: 'wiki_pedia' }, // â¬…ï¸ NOVO ITEM ADICIONADO
Â  Â  Â  Â  Â  Â  { name: 'jsonmulti-tabviewer (Gerador de Criptografia para HTML)', url: 'https://jsonmulti-tabviewer.wazzimagiygg.com/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' }, //g2MkzBni63mI1ijgdUi0
Â  Â  Â  Â  Â  Â  { name: 'ciphersafex - Criptografia de Texto', url: 'https://ciphersafex.wazzimagiygg.com', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },
Â  Â  Â  Â  Â  Â  { name: 'quill-sync', url: 'https://quill-sync.wazzimagiygg.com/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },//https://quill-sync.wazzimagiygg.com/
Â  Â  Â  Â  Â  Â  { name: 'tabwriter', url: 'https://tabwriter.wazzimagiygg.com/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' }, //EFX4N9Ocp9QlbLitZGvg
Â  Â  Â  Â  Â  Â  { name: 'encryptojson', url: 'https://encryptojson.wazzimagiygg.com/', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },
Â  Â  Â  Â  Â  Â  { name: 'file-scramble', url: 'https://file-scrambler.vercel.app', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },//10nqA0Oi4FQrdeUU5cKn
Â  Â  Â  Â  Â  Â  { name: 'Fandom - Wiki World Worker Web (ENGLISH)', url: 'https://wazzimagiygg.com/html/?uid=p8HnGTGNZGIDNa05a3dJ', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' }, //https://wazzimagiygg.com/gespai/
Â  Â  Â  Â  Â  Â  { name: 'Wiki World Worker WIKIDOT', url: 'https://wazzimagiygg.com/html/?uid=g2MkzBni63mI1ijgdUi0', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },
Â  Â  Â  Â  Â  Â  { name: 'UWG WIKIDOT - Universo WazzimaGiygg', url: 'https://wazzimagiygg.com/html/?uid=10nqA0Oi4FQrdeUU5cKn', iconUrl: 'iconmagic.png', menu_target: 'menu_iniciar' },//p8HnGTGNZGIDNa05a3dJÂ 
Â  Â  Â  Â  Â  Â  { name: "DailyMotion WazzimaGiygg", url: "html/?uid=zaoGYyamo3Z5CgNndhZ1", menu_target: 'wiki_pedia' },
Â  Â  Â  Â  Â  Â  { name: "Vimeo WazzimaGiygg", url: "html/?uid=EFX4N9Ocp9QlbLitZGvg", menu_target: 'wiki_pedia' },//zaoGYyamo3Z5CgNndhZ1
Â  Â  Â  Â  Â  Â  { name: "Chat (Contato)", url: "html/?uid=a13IwrEoc1Jmdi2I3Hve", menu_target: 'wiki_pedia' } //areadeensaiodeartigos.htmlÂ Â 
Â  Â  Â  Â  ];

Â  Â  Â  Â  // 3. MONTAGEM FINAL DAS LISTAS
Â  Â  Â  Â  const finalStartLinks = [...linksParaIniciar, ...staticStartLinks];
Â  Â  Â  Â  const finalAdminLinks = [...linksParaAdmin, ...staticAdminLinks];
Â  Â  Â  Â  const finalToolLinks = linksParaFerramentas; // Links dinÃ¢micos para ferramentas

Â  Â  Â  Â  // 4. CHAMA AS FUNÃ‡Ã•ES PARA MONTAR CADA MENU
Â  Â  Â  Â  populateMenu(startMenu, finalStartLinks); // Usa a funÃ§Ã£o de item de menu normal
Â  Â  Â  Â  populateMenu(adminMenu, finalAdminLinks); // Usa a funÃ§Ã£o de item de menu normal
Â  Â  Â  Â  populateToolsMenu(finalToolLinks); // Usa a funÃ§Ã£o especÃ­fica para links <a>

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Erro ao carregar links do Firebase:", error);
Â  Â  Â  Â  // Em caso de erro, monta o menu Iniciar apenas com os essenciais para nÃ£o quebrar
Â  Â  Â  Â  populateMenu(startMenu, [
Â  Â  Â  Â  Â  Â  Â { name: 'Fale com a AdministraÃ§Ã£o (Erro)', url: 'html/?uid=a13IwrEoc1Jmdi2I3Hve', iconUrl: 'iconmagic.png' },
Â  Â  Â  Â  Â  Â  Â { name: 'Logoff (Sair)', action: 'logout', iconUrl: 'iconmagic.png' }
Â  Â  Â  Â  ]);
Â  Â  Â  Â  populateMenu(adminMenu, [{ name: "Chat (Erro)", url: "#" }]);
Â  Â  Â  Â  populateToolsMenu([]);
Â  Â  }
}
// -------------------------------------------------------------
// FIM DA FUNÃ‡ÃƒO loadDynamicLinks
// -------------------------------------------------------------

// ğŸ†• FUNÃ‡ÃƒO UNIFICADA: PARA MONTAR MENUS EM GERAL (Iniciar e Admin)
function populateMenu(menuElement, linksArray) {
Â  Â  menuElement.innerHTML = '';Â 

Â  Â  linksArray.forEach(item => {
Â  Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  Â  div.className = "menu-item";
Â  Â  Â  Â  div.innerHTML = `<img src="${item.iconUrl || 'iconmagic.png'}" alt="icon"> ${item.name}`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  div.onclick = () => {
Â  Â  Â  Â  Â  Â  if (item.action === 'logout') {
Â  Â  Â  Â  Â  Â  Â  Â  handleLogout();Â 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  openWindow(item.name, item.url);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  menuElement.style.display = "none";Â 
Â  Â  Â  Â  };
Â  Â  Â  Â  menuElement.appendChild(div);
Â  Â  });
}

// -------------------------------------------------------------
// ğŸ†• FUNÃ‡ÃƒO ÃšNICA: PARA MONTAR O MENU DE FERRAMENTAS (usando links <a>)
// -------------------------------------------------------------
function populateToolsMenu(linksArray) {
Â  Â  toolsMenu.innerHTML = '';Â 
Â  Â Â 
Â  Â  // Filtro para remover links que incluem 'base44.app' ou 'base44.com'
Â  Â  const filteredLinks = linksArray.filter(link =>Â 
Â  Â  Â  Â  !link.url.includes('base44.app') && !link.url.includes('base44.com')
Â  Â  );
Â  Â Â 
Â  Â  filteredLinks.forEach(link => {
Â  Â  Â  Â  const a = document.createElement("a");
Â  Â  Â  Â  a.textContent = link.name;
Â  Â  Â  Â  a.href = link.url;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ğŸš¨ CORREÃ‡ÃƒO ESSENCIAL: Intercepta o clique para abrir o iframe.
Â  Â  Â  Â  a.onclick = (e) => {
Â  Â  Â  Â  Â  Â  e.preventDefault(); // <-- 1. IMPEDE a navegaÃ§Ã£o padrÃ£o do <a>
Â  Â  Â  Â  Â  Â  openWindow(link.name, link.url); // <-- 2. Chama a funÃ§Ã£o que cria a janela com iframe
Â  Â  Â  Â  Â  Â  toolsMenu.style.display = "none"; // <-- 3. Fecha o menu Ferramentas
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  toolsMenu.appendChild(a);
Â  Â  });
}

startBtn.onclick = () => {
Â  Â  startMenu.style.display = startMenu.style.display === "block" ? "none" : "block";
Â  Â  adminMenu.style.display = "none";
Â  Â  toolsMenu.style.display = "none";Â 
Â  Â  notificationPopup.style.display = "none";Â 
};

adminBtn.onclick = () => {
Â  Â  adminMenu.style.display = adminMenu.style.display === "block" ? "none" : "block";
Â  Â  startMenu.style.display = "none";
Â  Â  toolsMenu.style.display = "none";Â 
Â  Â  notificationPopup.style.display = "none";Â 
};

toolsBtn.onclick = () => {
Â  Â  const adminBtnWidth = adminBtn.offsetWidth;
Â  Â  // A tag toolsMenu tem a classe .admin-popup que a posiciona.
Â  Â  // O ajuste do 'left' precisa ser preciso, mas se a classe CSS for usada,
Â  Â  // o cÃ¡lculo do left pode ser feito dinamicamente.
Â  Â  // Uma aproximaÃ§Ã£o Ã©: (startBtn + adminBtn + 10px de margin)
Â  Â  toolsMenu.style.left = `${10 + startBtn.offsetWidth + adminBtnWidth + 10}px`;Â 

Â  Â  toolsMenu.style.display = toolsMenu.style.display === "block" ? "none" : "block";
Â  Â  startMenu.style.display = "none";
Â  Â  adminMenu.style.display = "none";Â 
Â  Â  notificationPopup.style.display = "none";Â 
};

function handleLogout() {
Â  Â  signOut(auth).then(() => {
Â  Â  Â  Â  // ...
Â  Â  }).catch((error) => {
Â  Â  Â  Â  console.error("Erro ao sair:", error);
Â  Â  Â  Â  alert("Erro ao tentar fazer logoff.");
Â  Â  });
}

// FunÃ§Ã£o para atualizar o relÃ³gioÂ 
function updateClock() {
Â  Â  const now = new Date();
Â  Â  const timeString = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit', hour12: false });
Â  Â  const dateString = now.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' });
Â  Â  clockElement.innerHTML = `<span>${timeString}</span><br><span>${dateString}</span>`;
Â  Â  setTimeout(updateClock, 1000);
}


function openWindow(title, url) {
Â  Â  const win = document.createElement("div");
Â  Â  win.className = "window";
Â  Â  win.innerHTML = `
Â  Â  Â  Â  <div class="window-header">
Â  Â  Â  Â  Â  Â  <span>${title}</span>
Â  Â  Â  Â  Â  Â  <div class="window-controls">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="minimize">â€”</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="maximize">â¬œ</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="close">âœ–</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <iframe src="${url}"></iframe>
Â  Â  `;
Â  Â  document.body.appendChild(win);

Â  Â  const header = win.querySelector(".window-header");
Â  Â  let isDragging = false;
Â  Â  let offsetX, offsetY;
Â  Â  let maximized = false;
Â  Â  let prev = { top: 0, left: 0, width: 0, height: 0 };

Â  Â  header.addEventListener("mousedown", (e) => {
Â  Â  Â  Â  isDragging = true;
Â  Â  Â  Â  offsetX = e.clientX - win.offsetLeft;
Â  Â  Â  Â  offsetY = e.clientY - win.offsetTop;
Â  Â  });

Â  Â  document.addEventListener("mousemove", (e) => {
Â  Â  Â  Â  if (isDragging && !maximized) {
Â  Â  Â  Â  Â  Â  win.style.left = e.clientX - offsetX + "px";
Â  Â  Â  Â  Â  Â  win.style.top = e.clientY - offsetY + "px";
Â  Â  Â  Â  }
Â  Â  });

Â  Â  document.addEventListener("mouseup", () => isDragging = false);

Â  Â  win.querySelector(".close").onclick = () => win.remove();
Â  Â  win.querySelector(".minimize").onclick = () => win.style.display = "none";
Â  Â  win.querySelector(".maximize").onclick = () => {
Â  Â  Â  Â  if (!maximized) {
Â  Â  Â  Â  Â  Â  prev = { top: win.offsetTop, left: win.offsetLeft, width: win.offsetWidth, height: win.offsetHeight };
Â  Â  Â  Â  Â  Â  win.style.top = "0";
Â  Â  Â  Â  Â  Â  win.style.left = "0";
Â  Â  Â  Â  Â  Â  win.style.width = "100%";
Â  Â  Â  Â  Â  Â  win.style.height = "calc(100% - 40px)";
Â  Â  Â  Â  Â  Â  maximized = true;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  win.style.top = prev.top + "px";
Â  Â  Â  Â  Â  Â  win.style.left = prev.left + "px";
Â  Â  Â  Â  Â  Â  win.style.width = prev.width + "px";
Â  Â  Â  Â  Â  Â  win.style.height = prev.height + "px";
Â  Â  Â  Â  Â  Â  maximized = false;
Â  Â  Â  Â  }
Â  Â  };
}

// ğŸ”¹ 1. FunÃ§Ã£o principal para buscar IP e LocalizaÃ§Ã£o (MANTIDA INTACTA)
async function buscarIpELocalizacao() {
Â  Â  notificationPopup.innerHTML = '';Â 
Â  Â  notificationIcon.style.color = 'white';
Â  Â Â 
Â  Â  try {
Â  Â  Â  Â  const response = await fetch('https://ipinfo.io/json');
Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â Â 
Â  Â  Â  Â  const ip = data.ip || 'N/A';
Â  Â  Â  Â  const cidadeDoUsuario = data.city || 'Desconhecida';
Â  Â  Â  Â  const paisDoUsuario = data.country || '';Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  addNotification(`Seu IP PÃºblico: <strong>${ip}</strong>`, 'info');
Â  Â  Â  Â  addNotification(`LocalizaÃ§Ã£o Detectada: ${cidadeDoUsuario}, ${paisDoUsuario}`, 'info');

Â  Â  Â  Â  verificarSancao(cidadeDoUsuario, paisDoUsuario);
Â  Â  Â  Â Â 
Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Erro ao obter IP ou localizaÃ§Ã£o:", error);
Â  Â  Â  Â  addNotification('Erro: Falha ao obter endereÃ§o IP/LocalizaÃ§Ã£o.', 'error');
Â  Â  }
}

// ğŸ”¹ 2. FunÃ§Ã£o para adicionar uma notificaÃ§Ã£o ao popup (MANTIDA INTACTA)
function addNotification(message, type = 'info') {
Â  Â  const div = document.createElement("div");
Â  Â  div.className = `notification-item ${type === 'error' ? 'sancao-alerta' : ''}`;
Â  Â  div.innerHTML = message;
Â  Â Â 
Â  Â  notificationPopup.prepend(div);Â 
}

// ğŸ”¹ 3. FunÃ§Ã£o para carregar o JSON e verificar sanÃ§Ã£o (MANTIDA INTACTA)
async function verificarSancao(cidadeUsuario, paisDoUsuario) {
Â  Â  try {
Â  Â  Â  Â  const jsonResponse = await fetch(JSON_URL);
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!jsonResponse.ok) {
Â  Â  Â  Â  Â  Â  throw new Error(`Erro HTTP! Status: ${jsonResponse.status}`);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const cidadesSancionadasData = await jsonResponse.json();
Â  Â  Â  Â Â 
Â  Â  Â  Â  const cidadeFormatada = cidadeUsuario.trim().toLowerCase();
Â  Â  Â  Â  const paisFormatado = paisDoUsuario.trim().toLowerCase();

Â  Â  Â  Â  const alertaEncontrado = cidadesSancionadasData.cidades_sancionadas.find(item =>Â 
Â  Â  Â  Â  Â  Â  item.cidade.trim().toLowerCase() === cidadeFormatada ||Â 
Â  Â  Â  Â  Â  Â  item.cidade.trim().toLowerCase() === paisFormatadoÂ  Â  Â Â 
Â  Â  Â  Â  );
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (alertaEncontrado) {
Â  Â  Â  Â  Â  Â  const alertaHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  ğŸš¨ Alerta de SanÃ§Ã£o! ğŸš¨<br>RegiÃ£o com possÃ­veis usuÃ¡rios sancionados.
Â  Â  Â  Â  Â  Â  Â  Â  <br>
Â  Â  Â  Â  Â  Â  Â  Â  (Moderador: <strong>${alertaEncontrado.moderador}</strong>)
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  addNotification(alertaHTML, 'error');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  notificationIcon.style.color = '#cc0000';
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  } catch (error) {
Â  Â  Â  Â  console.warn("Aviso: Falha ao carregar ou processar o JSON de sanÃ§Ãµes. Verifique o arquivo.", error);
Â  Â  }
}
</script>

</body>
</html>
